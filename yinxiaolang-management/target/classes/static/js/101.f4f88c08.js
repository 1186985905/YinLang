"use strict";(self["webpackChunkagentui"]=self["webpackChunkagentui"]||[]).push([[101],{7101:function(t,e,r){r.r(e),r.d(e,{default:function(){return m}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"prompt-config"},[e("h1",[t._v(" 提示词配置 "),e("div",{staticClass:"header-buttons"},[e("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-back"},on:{click:t.goBack}},[t._v("返回管理面板")]),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home"},on:{click:t.goHome}},[t._v("返回主页")])],1)]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-card",{staticClass:"department-card"},[e("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("部门列表")]),e("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:t.showAddDeptDialog}},[t._v("添加部门")])],1),e("div",{staticClass:"departments-list"},[t._l(t.departments,(function(r){return e("div",{key:r.id,staticClass:"department-item",class:{active:t.currentDept&&t.currentDept.id===r.id},on:{click:function(e){return t.handleDeptSelect(r)}}},[e("span",{staticClass:"dept-name"},[t._v(t._s(r.name))]),e("div",{staticClass:"dept-actions"},[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.editDepartment(r)}}},[e("i",{staticClass:"el-icon-edit"})]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.removeDepartment(r)}}},[e("i",{staticClass:"el-icon-delete"})])],1)])})),0===t.departments.length?e("div",{staticClass:"empty-dept"},[e("i",{staticClass:"el-icon-document"}),e("p",[t._v('暂无部门，请点击上方"添加部门"按钮添加')])]):t._e()],2)])],1),e("el-col",{attrs:{span:18}},[e("el-card",{staticClass:"prompt-card"},[e("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(t._s(t.currentDept?t.currentDept.name+" - 提示词模板列表":"请选择部门"))]),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus",disabled:!t.currentDept},on:{click:t.showAddPromptDialog}},[t._v(" 添加提示词模板 ")])],1),t.currentDept?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.promptList}},[e("el-table-column",{attrs:{prop:"title",label:"标题",width:"200"}}),e("el-table-column",{attrs:{prop:"content",label:"提示词内容"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("div",{staticClass:"prompt-content"},[t._v(t._s(r.row.content))])]}}],null,!1,3876841598)}),e("el-table-column",{attrs:{prop:"category",label:"分类",width:"120"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-tag",{attrs:{size:"medium"}},[t._v(t._s(r.row.category))])]}}],null,!1,2477035928)}),e("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.editPrompt(r.row)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(e){return t.removePrompt(r.row)}}},[t._v("删除")])]}}],null,!1,1482538074)})],1):e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),e("p",[t._v("请先选择左侧部门来管理提示词模板")])])],1)],1)],1),e("el-dialog",{attrs:{title:"add"===t.deptDialogType?"添加部门":"编辑部门",visible:t.deptDialogVisible,width:"500px"},on:{"update:visible":function(e){t.deptDialogVisible=e}}},[e("el-form",{ref:"deptForm",attrs:{model:t.deptForm,rules:t.deptRules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"请输入部门名称"},model:{value:t.deptForm.name,callback:function(e){t.$set(t.deptForm,"name",e)},expression:"deptForm.name"}})],1),e("el-form-item",{attrs:{label:"备注",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入部门备注信息（可选）"},model:{value:t.deptForm.remark,callback:function(e){t.$set(t.deptForm,"remark",e)},expression:"deptForm.remark"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.deptDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveDepartment}},[t._v("确定")])],1)],1),e("el-dialog",{attrs:{title:"add"===t.promptDialogType?"添加提示词模板":"编辑提示词模板",visible:t.promptDialogVisible,width:"650px"},on:{"update:visible":function(e){t.promptDialogVisible=e}}},[e("el-form",{ref:"promptForm",attrs:{model:t.promptForm,rules:t.promptRules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{attrs:{placeholder:"请输入提示词模板标题"},model:{value:t.promptForm.title,callback:function(e){t.$set(t.promptForm,"title",e)},expression:"promptForm.title"}})],1),e("el-form-item",{attrs:{label:"分类",prop:"category"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分类"},model:{value:t.promptForm.category,callback:function(e){t.$set(t.promptForm,"category",e)},expression:"promptForm.category"}},[e("el-option",{attrs:{label:"常用提示",value:"常用提示"}}),e("el-option",{attrs:{label:"工作流程",value:"工作流程"}}),e("el-option",{attrs:{label:"专业知识",value:"专业知识"}}),e("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e("el-form-item",{attrs:{label:"内容",prop:"content"}},[e("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入提示词模板内容"},model:{value:t.promptForm.content,callback:function(e){t.$set(t.promptForm,"content",e)},expression:"promptForm.content"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.promptDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.savePrompt}},[t._v("确定")])],1)],1)],1)},i=[],a=(r(4114),r(364)),o={name:"PromptConfig",data(){return{loading:!1,departments:[],currentDept:null,promptList:[],deptDialogVisible:!1,deptDialogType:"add",deptForm:{name:"",remark:""},deptRules:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:2,max:60,message:"长度在 2 到 60 个字符",trigger:"blur"}],remark:[{max:255,message:"备注最多 255 个字符",trigger:"blur"}]},promptDialogVisible:!1,promptDialogType:"add",promptForm:{title:"",content:"",department_id:null},promptRules:{title:[{required:!0,message:"请输入提示词模板标题",trigger:"blur"},{min:2,max:60,message:"长度在 2 到 60 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入提示词模板内容",trigger:"blur"},{min:2,max:360,message:"长度在 2 到 360 个字符",trigger:"blur"}]}}},methods:{goBack(){"/admin"!==this.$route.path&&this.$router.push("/admin")},goHome(){"/"!==this.$route.path&&this.$router.push("/")},async fetchDepartments(){try{this.loading=!0;const t=await(0,a.zz)();this.departments=Array.isArray(t.data)?t.data:[],this.departments.length>0&&!this.currentDept&&this.handleDeptSelect(this.departments[0])}catch(t){console.error("获取部门列表失败:",t),this.$message.error("获取部门列表失败"),this.departments=[]}finally{this.loading=!1}},async fetchPromptList(){if(this.currentDept)try{this.loading=!0;const t=await(0,a.RO)(this.currentDept.id);this.promptList=Array.isArray(t.data)?t.data:[]}catch(t){console.error("获取提示词列表失败:",t),this.$message.error("获取提示词列表失败"),this.promptList=[]}finally{this.loading=!1}else this.promptList=[]},async handleDeptSelect(t){t&&(this.currentDept=t,await this.fetchPromptList())},showAddDeptDialog(){this.deptDialogType="add",this.deptForm={name:"",remark:""},this.deptDialogVisible=!0},editDepartment(t){this.deptDialogType="edit",this.deptForm={id:t.id,name:t.name,remark:t.remark||""},this.deptDialogVisible=!0},async removeDepartment(t){try{await this.$confirm("确认删除该部门吗？相关的提示词模板也会被删除","提示",{type:"warning"}),await(0,a.Aj)(t.id),this.$message.success("删除部门成功"),this.currentDept&&this.currentDept.id===t.id&&(this.currentDept=null,this.promptList=[]),await this.fetchDepartments()}catch(e){"cancel"!==e&&(console.error("删除部门失败:",e),this.$message.error(e.message||"删除失败"))}},async saveDepartment(){try{await this.$refs.deptForm.validate(),"add"===this.deptDialogType?(await(0,a.YE)(this.deptForm),this.$message.success("添加部门成功")):(await(0,a.cM)(this.deptForm.id,this.deptForm),this.$message.success("更新部门成功")),this.deptDialogVisible=!1,this.resetDeptForm(),await this.fetchDepartments()}catch(t){console.error("保存部门失败:",t),this.$message.error(t.message||"操作失败")}},showAddPromptDialog(){this.currentDept?(this.promptDialogType="add",this.promptForm={title:"",content:"",department_id:this.currentDept.id},this.promptDialogVisible=!0):this.$message.warning("请先选择部门")},editPrompt(t){this.promptDialogType="edit",this.promptForm={...t},this.promptDialogVisible=!0},async removePrompt(t){try{await this.$confirm("确认删除该提示词模板吗？","提示",{type:"warning"}),await(0,a.Ir)(t.id,this.currentDept.id),this.$message.success("删除提示词模板成功"),await this.fetchPromptList()}catch(e){"cancel"!==e&&(console.error("删除提示词失败:",e),this.$message.error(e.message||"删除失败"))}},async savePrompt(){try{if(await this.$refs.promptForm.validate(),!this.currentDept)return void this.$message.warning("请先选择部门");this.promptForm.department_id=this.currentDept.id,"add"===this.promptDialogType?(await(0,a.Wz)(this.promptForm),this.$message.success("添加提示词模板成功")):(await(0,a.qj)(this.promptForm.id,this.promptForm),this.$message.success("更新提示词模板成功")),this.promptDialogVisible=!1,this.resetPromptForm(),await this.fetchPromptList()}catch(t){console.error("保存提示词失败:",t),this.$message.error(t.message||"操作失败")}},resetDeptForm(){this.$refs.deptForm.resetFields(),this.deptForm={name:"",remark:""}},resetPromptForm(){this.$refs.promptForm.resetFields(),this.promptForm={title:"",content:"",department_id:this.currentDept?this.currentDept.id:null}}},created(){this.fetchDepartments()}},l=o,p=r(1656),n=(0,p.A)(l,s,i,!1,null,"493a2cd9",null),m=n.exports}}]);
//# sourceMappingURL=101.f4f88c08.js.map