"use strict";(self["webpackChunkagentui"]=self["webpackChunkagentui"]||[]).push([[840],{3840:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-records"},[t("h1",[e._v(" 内容记录查询 "),t("div",{staticClass:"header-buttons"},[t("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回管理面板")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home"},on:{click:e.goHome}},[e._v("返回主页")])],1)]),t("el-card",{staticClass:"filter-card"},[t("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:e.filterForm,size:"small"}},[t("el-form-item",{attrs:{label:"时间范围"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.filterForm.dateRange,callback:function(t){e.$set(e.filterForm,"dateRange",t)},expression:"filterForm.dateRange"}})],1),t("el-form-item",{attrs:{label:"部门"}},[t("el-cascader",{attrs:{options:e.departmentOptions,props:{checkStrictly:!0},clearable:"",placeholder:"请选择部门"},model:{value:e.filterForm.department,callback:function(t){e.$set(e.filterForm,"department",t)},expression:"filterForm.department"}})],1),t("el-form-item",{attrs:{label:"用户"}},[t("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入用户名","remote-method":e.remoteSearchUsers,loading:e.userSearchLoading,clearable:""},model:{value:e.filterForm.userId,callback:function(t){e.$set(e.filterForm,"userId",t)},expression:"filterForm.userId"}},e._l(e.userOptions,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[t("span",[e._v(e._s(a.name))]),t("span",{staticClass:"user-email"},[e._v(e._s(a.email))])])})),1)],1),t("el-form-item",{attrs:{label:"内容搜索"}},[t("el-input",{attrs:{placeholder:"请输入关键词",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.filterForm.keyword,callback:function(t){e.$set(e.filterForm,"keyword",t)},expression:"filterForm.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetFilter}},[e._v("重置")]),t("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:e.exportRecords}},[e._v("导出")])],1)],1)],1),t("el-card",{staticClass:"table-card"},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"对话记录列表",name:"all"}}),t("el-tab-pane",{attrs:{label:"已标注对话",name:"marked"}},[t("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 已标注对话 "),e.markedRecords.length>0?t("el-badge",{staticClass:"mark-badge",attrs:{value:e.markedRecords.length}}):e._e()],1)])],1),t("div",{staticClass:"table-controls"},[t("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",disabled:0===e.selectedRecords.length},on:{click:e.handleBatchDelete}},[e._v("批量删除")]),t("el-radio-group",{attrs:{size:"small"},model:{value:e.viewMode,callback:function(t){e.viewMode=t},expression:"viewMode"}},[t("el-radio-button",{attrs:{label:"table"}},[e._v("表格视图")]),t("el-radio-button",{attrs:{label:"detail"}},[e._v("详细视图")])],1)],1)],1),"all"===e.activeTab&&"table"===e.viewMode?[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.recordsList},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"timestamp",label:"时间",width:"180",formatter:e.formatDate}}),t("el-table-column",{attrs:{prop:"department",label:"部门",width:"120"}}),t("el-table-column",{attrs:{prop:"username",label:"用户",width:"120"}}),t("el-table-column",{attrs:{prop:"question",label:"问题","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"remainingDays",label:"保存时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.remainingDays)+"天")]),t("el-button",{staticClass:"reset-button",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.resetSaveTime(a.row)}}},[t("i",{staticClass:"el-icon-refresh"})])]}}],null,!1,1376965608)}),t("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.viewDetail(a.row)}}},[e._v(" 查看详情 ")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.markRecord(a.row)}}},[e._v(" 标注对话 ")])]}}],null,!1,733546038)})],1)]:e._e(),"marked"===e.activeTab&&"table"===e.viewMode?[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.markedRecords},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"timestamp",label:"时间",width:"180",formatter:e.formatDate}}),t("el-table-column",{attrs:{prop:"department",label:"部门",width:"120"}}),t("el-table-column",{attrs:{prop:"username",label:"用户",width:"120"}}),t("el-table-column",{attrs:{prop:"question",label:"问题","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"markComment",label:"标注内容","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"remainingDays",label:"保存时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.remainingDays)+"天")]),t("el-button",{staticClass:"reset-button",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.resetSaveTime(a.row)}}},[t("i",{staticClass:"el-icon-refresh"})])]}}],null,!1,1376965608)}),t("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.viewDetail(a.row)}}},[e._v(" 查看详情 ")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.notifyUser(a.row)}}},[t("i",{staticClass:"el-icon-bell"}),e._v(" 提醒用户 ")])]}}],null,!1,1777351697)})],1)]:e._e(),"all"===e.activeTab&&"detail"===e.viewMode?[t("div",{staticClass:"detail-list"},e._l(e.recordsList,(function(a){return t("div",{key:a.id,staticClass:"detail-item"},[t("div",{staticClass:"detail-header"},[t("div",{staticClass:"detail-info"},[t("span",{staticClass:"time"},[e._v(e._s(e.formatDate(null,null,a.timestamp)))]),t("el-tag",{attrs:{size:"small",type:"info"}},[e._v(e._s(a.department))]),t("span",{staticClass:"username"},[e._v(e._s(a.username))])],1),t("div",{staticClass:"detail-actions"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.copyContent(a)}}},[e._v("复制内容")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.markRecord(a)}}},[e._v("标注对话")])],1)]),t("div",{staticClass:"conversation"},[t("div",{staticClass:"question"},[t("div",{staticClass:"avatar user"},[e._v("用户")]),t("div",{staticClass:"content"},[e._v(e._s(a.question))])]),t("div",{staticClass:"answer"},[t("div",{staticClass:"avatar assistant"},[e._v("AI")]),t("div",{staticClass:"content"},[e._v(e._s(a.answer))])])])])})),0)]:e._e(),"marked"===e.activeTab&&"detail"===e.viewMode?[t("div",{staticClass:"detail-list"},e._l(e.markedRecords,(function(a){return t("div",{key:a.id,staticClass:"detail-item"},[t("div",{staticClass:"detail-header"},[t("div",{staticClass:"detail-info"},[t("span",{staticClass:"time"},[e._v(e._s(e.formatDate(null,null,a.timestamp)))]),t("el-tag",{attrs:{size:"small",type:"info"}},[e._v(e._s(a.department))]),t("span",{staticClass:"username"},[e._v(e._s(a.username))])],1),t("div",{staticClass:"detail-actions"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.copyContent(a)}}},[e._v("复制内容")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.notifyUser(a)}}},[t("i",{staticClass:"el-icon-bell"}),e._v(" 提醒用户 ")])],1)]),t("div",{staticClass:"mark-comment"},[t("i",{staticClass:"el-icon-warning-outline"}),t("span",[e._v("标注内容："+e._s(a.markComment))])]),t("div",{staticClass:"conversation"},[t("div",{staticClass:"question"},[t("div",{staticClass:"avatar user"},[e._v("用户")]),t("div",{staticClass:"content"},[e._v(e._s(a.question))])]),t("div",{staticClass:"answer"},[t("div",{staticClass:"avatar assistant"},[e._v("AI")]),t("div",{staticClass:"content"},[e._v(e._s(a.answer))])])])])})),0)]:e._e(),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2),t("el-dialog",{attrs:{title:"对话详情",visible:e.dialogVisible,width:"600px","custom-class":"detail-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.currentRecord?[t("div",{staticClass:"dialog-header-info"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("时间：")]),t("span",[e._v(e._s(e.formatDate(null,null,e.currentRecord.timestamp)))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("部门：")]),t("span",[e._v(e._s(e.currentRecord.department))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("用户：")]),t("span",[e._v(e._s(e.currentRecord.username))])]),e.currentRecord.isMarked?t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("标注内容：")]),t("span",[e._v(e._s(e.currentRecord.markComment))])]):e._e()]),t("div",{staticClass:"dialog-conversation"},[t("div",{staticClass:"dialog-message user"},[t("div",{staticClass:"message-header"},[e._v("问题：")]),t("div",{staticClass:"message-content"},[e._v(e._s(e.currentRecord.question))])]),t("div",{staticClass:"dialog-message assistant"},[t("div",{staticClass:"message-header"},[e._v("回答：")]),t("div",{staticClass:"message-content"},[e._v(e._s(e.currentRecord.answer))])])])]:e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")]),e.currentRecord&&!e.currentRecord.isMarked?[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.markRecord(e.currentRecord)}}},[e._v("标注对话")])]:e.currentRecord&&e.currentRecord.isMarked?[t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.notifyUser(e.currentRecord)}}},[t("i",{staticClass:"el-icon-bell"}),e._v(" 提醒用户 ")])]:e._e()],2)],2),t("el-dialog",{attrs:{title:"标注对话",visible:e.markDialogVisible,width:"500px"},on:{"update:visible":function(t){e.markDialogVisible=t}}},[e.currentRecord?[t("div",{staticClass:"mark-info"},[t("div",[e._v("用户："+e._s(e.currentRecord.username))]),t("div",[e._v("问题："+e._s(e.currentRecord.question))])]),t("el-form",{ref:"markForm",attrs:{model:e.markForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"标注内容",prop:"comment",required:""}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入标注内容，说明问题所在..."},model:{value:e.markForm.comment,callback:function(t){e.$set(e.markForm,"comment",t)},expression:"markForm.comment"}})],1)],1)]:e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.markDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitMark}},[e._v("确定")])],1)],2)],1)},i=[],r=(a(4114),a(8111),a(2489),a(1701),{name:"ContentRecords",data(){return{loading:!1,userSearchLoading:!1,viewMode:"table",activeTab:"all",currentPage:1,pageSize:10,total:0,dialogVisible:!1,markDialogVisible:!1,currentRecord:null,markForm:{comment:""},filterForm:{dateRange:[],department:[],userId:"",keyword:""},departmentOptions:[{value:1,label:"研发部",children:[{value:4,label:"前端组"},{value:5,label:"后端组"}]},{value:2,label:"产品部"},{value:3,label:"运营部"}],userOptions:[],recordsList:[{id:1,timestamp:"2024-03-20 10:30:00",department:"研发部-前端组",username:"张三",question:"如何优化React组件的性能？",answer:"优化React组件性能可以从以下几个方面入手：1. 使用React.memo()避免不必要的重渲染 2. 合理使用useMemo和useCallback 3. 使用虚拟列表处理长列表 4. 避免内联对象和函数...",isMarked:!1,markComment:"",remainingDays:25},{id:2,timestamp:"2024-03-20 11:15:00",department:"研发部-后端组",username:"李四",question:"如何处理Node.js中的内存泄漏问题？",answer:"处理Node.js内存泄漏可以：1. 使用heapdump分析内存快照 2. 避免闭包造成的引用无法释放 3. 及时清理定时器和事件监听器 4. 使用WeakMap/WeakSet处理对象引用...",isMarked:!1,markComment:"",remainingDays:18},{id:3,timestamp:"2024-03-20 14:05:00",department:"产品部",username:"王五",question:"茵浪AI系统与其他AI产品相比有什么优势？",answer:"茵浪AI系统的主要优势包括：1. 支持多种AI模型集成，可根据需求灵活切换 2. 针对企业内部知识库深度优化，提供更准确的答案 3. 完善的权限管理和数据安全机制 4. 支持自定义训练和微调，更贴合特定行业需求...",isMarked:!1,markComment:"",remainingDays:22},{id:4,timestamp:"2024-03-21 09:20:00",department:"市场部",username:"赵六",question:"如何利用AI改进我们的市场营销策略？",answer:"AI可以通过以下方式改进市场营销：1. 精准客户分群，提供个性化内容推荐 2. 预测市场趋势和消费者行为 3. 智能内容生成，提高创意效率 4. 全渠道数据分析，优化营销投入...",isMarked:!1,markComment:"",remainingDays:30}],markedRecords:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},selectedRecords:[]}},methods:{goBack(){"/admin"!==this.$route.path&&this.$router.push("/admin")},goHome(){"/"!==this.$route.path&&this.$router.push("/")},handleSearch(){this.currentPage=1,this.fetchRecords()},resetFilter(){this.filterForm={dateRange:[],department:[],userId:"",keyword:""},this.handleSearch()},handleSizeChange(e){this.pageSize=e,this.fetchRecords()},handleCurrentChange(e){this.currentPage=e,this.fetchRecords()},formatDate(e,t,a){return a},viewDetail(e){this.currentRecord=e,this.dialogVisible=!0},copyContent(e){const t=`问题：${e.question}\n\n回答：${e.answer}`;navigator.clipboard.writeText(t).then((()=>{this.$message.success("内容已复制到剪贴板")})).catch((()=>{this.$message.error("复制失败，请手动复制")}))},async remoteSearchUsers(e){e&&(this.userSearchLoading=!0,setTimeout((()=>{this.userOptions=[{id:1,name:"张三",email:"zhangsan@example.com"},{id:2,name:"李四",email:"lisi@example.com"}].filter((t=>t.name.includes(e))),this.userSearchLoading=!1}),500))},fetchRecords(){this.loading=!0,setTimeout((()=>{this.total=this.recordsList.length,this.loading=!1}),500)},exportRecords(){this.$message({message:"导出功能开发中...",type:"info"})},markRecord(e){this.currentRecord=e,this.markForm.comment=e.markComment||"",this.markDialogVisible=!0},submitMark(){if(!this.markForm.comment.trim())return void this.$message.warning("请输入标注内容");const e=this.recordsList.findIndex((e=>e.id===this.currentRecord.id));if(-1!==e){const t={...this.recordsList[e],isMarked:!0,markComment:this.markForm.comment};this.$set(this.recordsList,e,t);const a=this.markedRecords.findIndex((e=>e.id===t.id));-1!==a?this.$set(this.markedRecords,a,t):this.markedRecords.push(t),this.$message.success("标注成功"),this.markDialogVisible=!1}},notifyUser(e){this.$confirm(`确定要提醒用户"${e.username}"关于此对话的问题吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$message({type:"success",message:`已成功提醒用户"${e.username}"！`})})).catch((()=>{}))},handleSelectionChange(e){this.selectedRecords=e},handleBatchDelete(){0!==this.selectedRecords.length?this.$confirm(`确认要批量删除选中的 ${this.selectedRecords.length} 条记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=this.selectedRecords.map((e=>e.id));"all"===this.activeTab?this.recordsList=this.recordsList.filter((t=>!e.includes(t.id))):this.markedRecords=this.markedRecords.filter((t=>!e.includes(t.id))),this.$message.success(`成功删除${e.length}条记录`),this.selectedRecords=[]})).catch((()=>{})):this.$message.warning("请选择要删除的记录")},resetSaveTime(e){this.$confirm("确认要重置此对话的保存时间吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((()=>{e.remainingDays=30,this.$message.success("保存时间已重置为30天")})).catch((()=>{}))}},created(){this.fetchRecords()}}),l=r,n=a(1656),o=(0,n.A)(l,s,i,!1,null,"5b137ae5",null),c=o.exports}}]);
//# sourceMappingURL=840.125e67e0.js.map