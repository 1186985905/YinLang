"use strict";(self["webpackChunkagentui"]=self["webpackChunkagentui"]||[]).push([[406],{4406:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"log-viewer"},[t("h1",[e._v(" 系统日志查看 "),t("div",{staticClass:"header-buttons"},[t("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回管理面板")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home"},on:{click:e.goHome}},[e._v("返回主页")])],1)]),t("el-card",{staticClass:"filter-card"},[t("div",{staticClass:"filter-section"},[t("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:e.filterForm}},[t("el-form-item",{attrs:{label:"时间范围"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.handleDateChange},model:{value:e.filterForm.dateRange,callback:function(t){e.$set(e.filterForm,"dateRange",t)},expression:"filterForm.dateRange"}})],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},on:{clear:e.handleFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter.apply(null,arguments)}},model:{value:e.filterForm.username,callback:function(t){e.$set(e.filterForm,"username",t)},expression:"filterForm.username"}})],1),t("el-form-item",{attrs:{label:"操作类型"}},[t("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:e.handleFilter},model:{value:e.filterForm.actionType,callback:function(t){e.$set(e.filterForm,"actionType",t)},expression:"filterForm.actionType"}},[t("el-option",{attrs:{label:"登录/登出",value:"login_logout"}}),t("el-option",{attrs:{label:"文本对话",value:"text_chat"}}),t("el-option",{attrs:{label:"图像生成",value:"image_generation"}}),t("el-option",{attrs:{label:"模型配置",value:"model_config"}}),t("el-option",{attrs:{label:"用户管理",value:"user_management"}}),t("el-option",{attrs:{label:"对话记录删除",value:"chat_delete"}}),t("el-option",{attrs:{label:"图片删除",value:"image_delete"}}),t("el-option",{attrs:{label:"提示词配置",value:"prompt_config"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetFilter}},[e._v("重置")])],1)],1)],1)]),t("el-card",{staticClass:"log-table-card"},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("操作日志列表")]),t("div",{staticClass:"header-actions"},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-download"},on:{click:e.exportLogs}},[e._v("导出日志")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.logData,border:""}},[t("el-table-column",{attrs:{prop:"timestamp",label:"时间",width:"180",formatter:e.formatDate}}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"150"}}),t("el-table-column",{attrs:{prop:"action",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getActionTagType(a.row.action)}},[e._v(" "+e._s(e.getActionName(a.row.action))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"ip",label:"IP地址",width:"150"}}),t("el-table-column",{attrs:{prop:"device",label:"设备信息"}})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},l=[],n=(a(4114),a(8111),a(2489),{name:"LogViewer",data(){return{loading:!1,filterForm:{dateRange:[],username:"",actionType:""},currentPage:1,pageSize:10,total:0,logData:[{id:1,timestamp:"2024-03-20 09:30:00",username:"admin",action:"login",ip:"192.168.1.100",device:"Chrome 122.0.0 / Windows 10"},{id:2,timestamp:"2024-03-20 10:15:00",username:"user1",action:"text_chat",ip:"192.168.1.101",device:"Safari / MacOS"},{id:3,timestamp:"2024-03-20 11:20:00",username:"user2",action:"image_generation",ip:"192.168.1.102",device:"Firefox / Ubuntu"},{id:4,timestamp:"2024-03-20 12:45:00",username:"admin",action:"model_add",ip:"192.168.1.100",device:"Chrome 122.0.0 / Windows 10"},{id:5,timestamp:"2024-03-20 13:30:00",username:"admin",action:"user_update",ip:"192.168.1.100",device:"Chrome 122.0.0 / Windows 10"},{id:6,timestamp:"2024-03-20 15:20:00",username:"admin",action:"logout",ip:"192.168.1.100",device:"Chrome 122.0.0 / Windows 10"},{id:7,timestamp:"2024-03-20 16:10:00",username:"user1",action:"prompt_config",ip:"192.168.1.101",device:"Safari / MacOS"},{id:8,timestamp:"2024-03-20 17:00:00",username:"user2",action:"image_delete",ip:"192.168.1.102",device:"Firefox / Ubuntu"}],pickerOptions:{shortcuts:[{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},methods:{goBack(){this.$router.push("/admin")},goHome(){this.$router.push("/")},formatDate(e){return e.timestamp},handleFilter(){this.currentPage=1,this.fetchLogs()},resetFilter(){this.filterForm={dateRange:[],username:"",actionType:""},this.handleFilter()},handleSizeChange(e){this.pageSize=e,this.fetchLogs()},handleCurrentChange(e){this.currentPage=e,this.fetchLogs()},handleDateChange(){this.handleFilter()},fetchLogs(){this.loading=!0,setTimeout((()=>{let e=[...this.logData];if(this.filterForm.username&&(e=e.filter((e=>e.username.toLowerCase().includes(this.filterForm.username.toLowerCase())))),this.filterForm.actionType&&(e="login_logout"===this.filterForm.actionType?e.filter((e=>"login"===e.action||"logout"===e.action)):"model_config"===this.filterForm.actionType?e.filter((e=>"model_add"===e.action||"model_update"===e.action||"model_delete"===e.action)):"user_management"===this.filterForm.actionType?e.filter((e=>"user_add"===e.action||"user_update"===e.action||"user_delete"===e.action)):e.filter((e=>e.action===this.filterForm.actionType))),this.filterForm.dateRange&&2===this.filterForm.dateRange.length){const t=new Date(this.filterForm.dateRange[0]),a=new Date(this.filterForm.dateRange[1]);a.setHours(23,59,59,999),e=e.filter((e=>{const i=new Date(e.timestamp);return i>=t&&i<=a}))}this.total=e.length,this.logData=e,this.loading=!1}),500)},exportLogs(){this.$message({message:"日志导出功能开发中...",type:"info"})},getActionTagType(e){const t={login:"success",logout:"success",text_chat:"primary",image_generation:"warning",model_add:"success",model_update:"warning",model_delete:"danger",user_add:"success",user_update:"warning",user_delete:"danger",chat_delete:"danger",image_delete:"danger",prompt_config:"info"};return t[e]||"info"},getActionName(e){const t={login:"登录/登出",logout:"登录/登出",text_chat:"文本对话",image_generation:"图像生成",model_add:"模型配置",model_update:"模型配置",model_delete:"模型配置",user_add:"用户管理",user_update:"用户管理",user_delete:"用户管理",chat_delete:"对话记录删除",image_delete:"图片删除",prompt_config:"提示词配置"};return t[e]||e}},created(){this.fetchLogs()}}),o=n,r=a(1656),s=(0,r.A)(o,i,l,!1,null,"7f3aac43",null),c=s.exports}}]);
//# sourceMappingURL=406.6454cd55.js.map