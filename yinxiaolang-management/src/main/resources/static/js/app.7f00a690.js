(function(){"use strict";var e={364:function(e,t,s){s.d(t,{Aj:function(){return o},Ir:function(){return u},RO:function(){return l},Wz:function(){return c},YE:function(){return i},cM:function(){return n},qj:function(){return d},zz:function(){return r}});var a=s(5720);function r(){return(0,a.A)({url:"/api/departments",method:"get"})}function i(e){return(0,a.A)({url:"/api/departments",method:"post",data:e})}function n(e,t){return(0,a.A)({url:`/api/departments/${e}`,method:"put",data:t})}function o(e){return(0,a.A)({url:`/api/departments/${e}`,method:"delete"})}function l(e){return(0,a.A)({url:`/api/departments/${e}/prompts`,method:"get"})}function c(e){const{department_id:t,...s}=e;return(0,a.A)({url:`/api/departments/${t}/prompts`,method:"post",data:s})}function d(e,t){const{department_id:s,...r}=t;return(0,a.A)({url:`/api/departments/${s}/prompts/${e}`,method:"put",data:r})}function u(e,t){return(0,a.A)({url:`/api/departments/${t}/prompts/${e}`,method:"delete"})}},1126:function(e,t,s){e.exports=s.p+"img/back.d23e5f19.png"},2549:function(e,t,s){s.d(t,{TK:function(){return n},aU:function(){return r},hG:function(){return o},kg:function(){return i}});var a=s(5720);function r(e){const t=e.page||1,s=e.pageSize||10;let r,i;return e.timeRange&&2===e.timeRange.length&&(r=e.timeRange[0],i=e.timeRange[1]),(0,a.A)({url:"/api/users",method:"get",params:{username:e.username||void 0,departmentId:e.departmentId||void 0,role:e.role||void 0,startTime:r,endTime:i,pageNum:t,pageSize:s}})}function i(e){return(0,a.A)({url:"/api/users",method:"post",data:{username:e.username,password:e.password,departmentId:e.departmentId,role:e.role}})}function n(e,t){return(0,a.A)({url:`/api/users/${e}`,method:"put",data:{departmentId:t.departmentId,role:t.role}})}function o(e){return(0,a.A)({url:`/api/users/${e}`,method:"delete"})}},5414:function(e,t,s){var a=s(6848),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},["/login"===e.$route.path?[t("router-view")]:[t("el-container",{staticClass:"main-container"},[t("el-main",{class:{"no-padding":"/"===e.$route.path}},[t("router-view")],1)],1)],t("AppAccountModal",{attrs:{visible:e.isAccountModalVisible},on:{"update:visible":function(t){e.isAccountModalVisible=t}}})],2)},i=[],n=(s(4114),function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"account-modal",attrs:{visible:e.localVisible,width:"500px","show-close":!0,"append-to-body":"",title:"个人信息","custom-class":"account-dialog-custom"},on:{"update:visible":function(t){e.localVisible=t}}},[e.isEditing?t("el-form",{ref:"userForm",staticClass:"edit-form",attrs:{model:e.userForm,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"留空表示不修改","show-password":""},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),e.userForm.password?t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password","show-password":""},model:{value:e.userForm.confirmPassword,callback:function(t){e.$set(e.userForm,"confirmPassword",t)},expression:"userForm.confirmPassword"}})],1):e._e(),t("el-form-item",{attrs:{label:"部门",prop:"department"}},[t("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.userForm.department,callback:function(t){e.$set(e.userForm,"department",t)},expression:"userForm.department"}},e._l(e.departments,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"form-actions"},[t("el-button",{on:{click:e.cancelEdit}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveUserInfo}},[e._v("保存")])],1)],1):t("div",{staticClass:"user-profile-info"},[t("el-avatar",{staticClass:"user-avatar",attrs:{size:80}},[e._v(e._s(e.userInitial))]),t("h3",{staticClass:"username"},[e._v(e._s(e.currentUser.username||"未登录"))]),t("div",{staticClass:"info-items"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("密码：")]),t("span",{staticClass:"info-value"},[e._v("••••••••")])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("部门：")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.currentUser.department||"未分配"))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("权限：")]),t("span",{staticClass:"info-value"},[e.isAdmin?t("el-tag",{attrs:{type:"primary",size:"small"}},[e._v("超级管理员")]):t("el-tag",{attrs:{size:"small"}},[e._v("普通用户")])],1)]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("创建时间：")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.currentUser.createdAt||"2024-01-01 12:00:00"))])])]),t("div",{staticClass:"account-actions"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.startEditing}},[e._v("编辑信息")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-switch-button"},on:{click:e.logout}},[e._v("退出登录")])],1)],1)],1)}),o=[],l=s(3518),c={name:"AccountModal",props:{visible:{type:Boolean,default:!1}},data(){const e=(e,t,s)=>{t!==this.userForm.password?s(new Error("两次输入密码不一致!")):s()};return{localVisible:this.visible,isEditing:!1,departments:[{id:1,name:"技术部"},{id:2,name:"市场部"},{id:3,name:"运营部"},{id:4,name:"产品部"},{id:5,name:"客服部"}],userForm:{username:"",password:"",confirmPassword:"",department:null},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],password:[{min:6,message:"密码长度不能少于6个字符",trigger:"blur"}],confirmPassword:[{validator:e,trigger:"blur"}],department:[{required:!0,message:"请选择部门",trigger:"change"}]}}},computed:{...(0,l.L8)(["currentUser","isAdmin"]),userInitial(){return this.currentUser&&this.currentUser.username?this.currentUser.username.charAt(0).toUpperCase():"?"}},watch:{visible(e){this.localVisible=e,e&&(this.isEditing=!1)},localVisible(e){this.$emit("update:visible",e),e||(this.isEditing=!1)},currentUser:{handler(e){e&&(this.userForm.username=e.username||"",this.userForm.department=e.departmentId||null)},immediate:!0}},methods:{...(0,l.i0)(["logout","updateUserProfile"]),startEditing(){this.userForm={username:this.currentUser.username||"",password:"",confirmPassword:"",department:this.currentUser.departmentId||null},this.isEditing=!0},cancelEdit(){this.isEditing=!1},saveUserInfo(){this.$refs.userForm.validate((e=>{if(!e)return!1;{const e={...this.currentUser,username:this.userForm.username,departmentId:this.userForm.department};this.userForm.password&&(e.password=this.userForm.password),this.updateUserProfile(e).then((()=>{this.$message.success("个人信息更新成功"),this.isEditing=!1})).catch((e=>{this.$message.error("更新失败: "+e.message)}))}}))}}},d=c,u=s(1656),m=(0,u.A)(d,n,o,!1,null,"731a9c3a",null),p=m.exports,h={name:"App",components:{AppAccountModal:p},computed:{...(0,l.L8)(["isAccountModalVisible","isAdmin","currentUser"]),isMobile(){return window.innerWidth<=767}},data(){return{darkThemeEnabled:!1}},methods:{...(0,l.i0)(["toggleAccountModal","logout"]),handleCommand(e){"logout"===e?(this.logout(),this.$router.push("/login")):"admin"===e&&(this.$route.path.includes("/admin")?this.$router.push("/"):this.$router.push("/admin"))}}},f=h,g=(0,u.A)(f,r,i,!1,null,null,null),v=g.exports,b=(s(8111),s(3579),s(6178)),y=function(){var e=this,t=e._self._c;return t("div",[t("app-layout",{attrs:{"sidebar-active":e.sidebarActive,"active-tab":"chat","sidebar-title":"历史对话","new-button-text":"新对话"},on:{"toggle-sidebar":e.toggleSidebar,"create-new-chat":e.createNewChat,command:e.handleCommand,share:e.shareHistory},scopedSlots:e._u([{key:"sidebar-content",fn:function(){return e._l(e.chatHistoryList,(function(s,a){return t("div",{key:a,staticClass:"history-item",class:{active:e.currentChatIndex===a},on:{click:function(t){return e.switchChat(a)}}},[t("div",{staticClass:"history-item-content"},[t("i",{staticClass:"el-icon-chat-dot-round"}),t("span",{staticClass:"history-title"},[e._v(e._s(s.title))])]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:t=>e.handleChatAction(t,a),click:function(e){e.stopPropagation()}}},[t("i",{staticClass:"el-icon-more"}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"rename"}},[e._v("重命名")]),t("el-dropdown-item",{attrs:{command:"share"}},[e._v("导出")]),t("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")])],1)],1)],1)}))},proxy:!0}])},[t("div",{ref:"chatHistory",staticClass:"chat-history"},[0===e.currentChat.messages.length?t("div",{staticClass:"empty-chat-container"},[t("div",{staticClass:"greeting-section"},[t("div",{staticClass:"greeting-header"},[t("img",{staticClass:"logo-image",attrs:{src:s(1126),alt:"Logo"}}),t("h1",{staticClass:"greeting-title"},[e._v("Hi~ 我是茵小浪")])]),t("p",{staticClass:"greeting-subtitle"},[e._v(" 你身边的智能助手，可以为你答疑解惑、尽情创作各种精美图片，快来体验一下吧~ ")])]),t("div",{staticClass:"prompt-section"},[t("div",{staticClass:"prompt-title"},[e._v("你可以这样问")]),t("div",{staticClass:"prompt-list"},[t("div",{staticClass:"prompt-item",on:{click:function(t){return e.selectPrompt("午睡20分钟为什么能重置大脑运行效率？")}}},[e._v(" 午睡20分钟为什么能重置大脑运行效率？ ")]),t("div",{staticClass:"prompt-item",on:{click:function(t){return e.selectPrompt("帮我生成一张水彩风格的湖边日落场景")}}},[e._v(" 帮我生成一张水彩风格的湖边日落场景 ")]),t("div",{staticClass:"prompt-item",on:{click:function(t){return e.selectPrompt("作为忙碌的成年人，如何重建生活和心理的秩序？")}}},[e._v(" 作为忙碌的成年人，如何重建生活和心理的秩序？ ")])])]),t("div",{staticClass:"input-box"},[t("div",{staticClass:"input-area-centered"},[t("div",{staticClass:"model-dropdown"},[t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.changeModel}},[t("div",{staticClass:"model-name-display"},[t("i",{staticClass:"el-icon-cpu"}),e._v(" "+e._s(e.currentModel)+" "),t("i",{staticClass:"el-icon-arrow-down"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"GPT-4o"}},[e._v("GPT-4o")]),t("el-dropdown-item",{attrs:{command:"deepseek-v3"}},[e._v("deepseek-v3")]),t("el-dropdown-item",{attrs:{command:"Qwen2.5-Max"}},[e._v("Qwen2.5-Max")])],1)],1)],1),t("el-input",{staticClass:"chat-input",attrs:{type:"textarea",rows:1,placeholder:"给 DeepSeek 发送消息",resize:"none"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.sendMessage.apply(null,arguments))}},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}}),t("div",{staticClass:"input-actions"},[t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-link",circle:"",size:"small"},on:{click:e.uploadFile}}),t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-picture-outline",circle:"",size:"small"},on:{click:e.uploadImage}}),t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-microphone",circle:"",size:"small"},on:{click:e.startVoiceInput}}),t("el-button",{staticClass:"send-button",attrs:{type:"primary",icon:"el-icon-s-promotion",disabled:!e.userInput.trim()},on:{click:e.sendMessage}})],1)],1)])]):e._e(),e.currentChat.messages.length>0?t("div",{staticClass:"chat-messages"},e._l(e.currentChat.messages,(function(a,r){return t("div",{key:r,class:["message","user"===a.role?"user-message":"assistant-message"]},["assistant"===a.role?t("div",{staticClass:"message-avatar"},[t("img",{staticClass:"avatar-image",attrs:{src:s(8178),alt:"AI"}})]):t("div",{staticClass:"message-avatar user-avatar-container"},[t("div",{staticClass:"user-message-avatar"},[e._v(e._s(e.userInitial))])]),t("div",{staticClass:"message-bubble"},["assistant"===a.role?t("div",{staticClass:"message-header"},[t("div",{staticClass:"model-info"},[t("span",{staticClass:"model-name"},[e._v(e._s(a.model||e.currentModel))]),t("span",{staticClass:"response-time"},[e._v(e._s(a.time||(new Date).toLocaleString("zh-CN",{hour12:!1})))])])]):t("div",{staticClass:"message-header"},[t("div",{staticClass:"user-info"},[t("span",{staticClass:"send-time"},[e._v(e._s(a.time||(new Date).toLocaleString("zh-CN",{hour12:!1})))])])]),"user"===a.role||!a.imageUrl&&"assistant"===a.role?t("div",{staticClass:"message-content"},[e._v(" "+e._s(a.content)+" ")]):e._e(),a.imageUrl&&"assistant"===a.role?t("div",{staticClass:"image-content"},[t("div",{staticClass:"message-text"},[e._v(e._s(a.content))]),t("img",{staticClass:"generated-image",attrs:{src:a.imageUrl,alt:"Generated Image"},on:{load:e.scrollToBottom,error:e.handleImageError}})]):e._e(),"assistant"===a.role?t("div",{staticClass:"message-actions"},[a.imageUrl?[t("i",{staticClass:"el-icon-star-off",class:{liked:a.liked},attrs:{title:"点赞"},on:{click:function(t){return e.likeMessage(a)}}}),t("i",{staticClass:"el-icon-download",attrs:{title:"下载"},on:{click:function(t){return e.downloadImage(a)}}}),t("i",{staticClass:"el-icon-delete",attrs:{title:"删除"},on:{click:function(t){return e.deleteMessage(r)}}}),t("i",{staticClass:"el-icon-refresh",attrs:{title:"重新生成"},on:{click:function(t){return e.regenerateMessage(r)}}})]:[t("i",{staticClass:"el-icon-document-copy",attrs:{title:"复制"},on:{click:function(t){return e.copyMessage(a)}}}),t("i",{staticClass:"el-icon-delete",attrs:{title:"删除"},on:{click:function(t){return e.deleteMessage(r)}}}),t("i",{staticClass:"el-icon-refresh",attrs:{title:"重新生成"},on:{click:function(t){return e.regenerateMessage(r)}}})]],2):e._e()])])})),0):e._e()]),e.currentChat.messages.length>0?t("div",{staticClass:"footer-input-container"},[t("div",{staticClass:"input-area-bottom"},[t("div",{staticClass:"model-dropdown"},[t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.changeModel}},[t("div",{staticClass:"model-name-display"},[t("i",{staticClass:"el-icon-cpu"}),e._v(" "+e._s(e.currentModel)+" "),t("i",{staticClass:"el-icon-arrow-down"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"GPT-4o"}},[e._v("GPT-4o")]),t("el-dropdown-item",{attrs:{command:"deepseek-v3"}},[e._v("deepseek-v3")]),t("el-dropdown-item",{attrs:{command:"Qwen2.5-Max"}},[e._v("Qwen2.5-Max")])],1)],1)],1),t("el-input",{staticClass:"chat-input",attrs:{type:"textarea",rows:1,placeholder:"给 DeepSeek 发送消息",resize:"none"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.sendMessage.apply(null,arguments))}},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}}),t("div",{staticClass:"input-actions"},[t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-link",circle:"",size:"small"},on:{click:e.uploadFile}}),t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-picture-outline",circle:"",size:"small"},on:{click:e.uploadImage}}),t("el-button",{staticClass:"action-btn",attrs:{icon:"el-icon-microphone",circle:"",size:"small"},on:{click:e.startVoiceInput}}),t("el-button",{staticClass:"send-button",attrs:{type:"primary",icon:"el-icon-s-promotion",disabled:!e.userInput.trim()},on:{click:e.sendMessage}})],1)],1)]):e._e()]),t("user-preferences",{attrs:{visible:e.preferencesVisible},on:{"update:visible":function(t){e.preferencesVisible=t},save:e.savePreferences}}),t("share-dialog",{attrs:{visible:e.shareDialogVisible,"share-link":e.shareLink},on:{"update:visible":function(t){e.shareDialogVisible=t},close:function(t){e.shareDialogVisible=!1}}}),t("account-modal",{attrs:{visible:e.accountModalVisible},on:{"update:visible":function(t){e.accountModalVisible=t}}})],1)},C=[],_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"chat-sidebar",class:{active:e.sidebarActive}},[t("div",{staticClass:"sidebar-header"},[t("span",{staticClass:"sidebar-title"},[e._v(e._s(e.sidebarTitle))]),t("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.createNewChat}},[e._v(e._s(e.newButtonText))])],1),t("div",{staticClass:"chat-history-list"},[e._t("sidebar-content")],2)]),e.isMobile&&e.sidebarActive?t("div",{staticClass:"sidebar-overlay",on:{click:e.toggleSidebar}}):e._e(),t("div",{staticClass:"main-content"},[t("div",{staticClass:"top-bar"},[t("div",{staticClass:"left-section"},[t("el-button",{staticClass:"sidebar-toggle-btn",attrs:{icon:"el-icon-s-fold"},on:{click:e.toggleSidebar}})],1),t("div",{staticClass:"user-actions"},[t("el-button",{staticClass:"share-btn",attrs:{type:"text",icon:"el-icon-share"},on:{click:function(t){return e.$emit("share")}}},[e._v("共享")]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[t("el-avatar",{staticClass:"user-avatar",attrs:{size:"small"}},[e._v(" "+e._s(e.userInitial)+" ")]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"profile"}},[t("i",{staticClass:"el-icon-user"}),e._v(" 个人信息 ")]),t("el-dropdown-item",{attrs:{command:"preferences"}},[t("i",{staticClass:"el-icon-setting"}),e._v(" 偏好设置 ")]),e.isAdmin?t("el-dropdown-item",{attrs:{command:"admin"}},[t("i",{staticClass:"el-icon-s-tools"}),e._v(" 管理面板 ")]):e._e(),t("el-dropdown-item",{attrs:{command:"logout"}},[t("i",{staticClass:"el-icon-switch-button"}),e._v(" 退出登录 ")])],1)],1)],1)]),t("div",{staticClass:"content-area"},[e._t("default")],2)])])},w=[],k={name:"AppLayout",props:{sidebarActive:{type:Boolean,default:!0},activeTab:{type:String,required:!0,validator:e=>["chat","text","image"].includes(e)},sidebarTitle:{type:String,default:"历史对话"},newButtonText:{type:String,default:"新对话"}},computed:{...(0,l.L8)(["currentUser","isAdmin"]),userInitial(){return this.currentUser?this.currentUser.username.charAt(0).toUpperCase():"?"},isMobile(){return window.innerWidth<=767}},methods:{toggleSidebar(){this.$emit("toggle-sidebar")},createNewChat(){this.$emit("create-new-chat")},handleCommand(e){this.$emit("command",e)}}},A=k,x=(0,u.A)(A,_,w,!1,null,"37a0f2c7",null),$=x.exports,P=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"preferences-dialog",attrs:{title:"偏好设置",visible:e.visible,width:"600px"},on:{close:e.handleClose}},[t("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"常规设置",name:"general"}},[t("el-form",{attrs:{model:e.preferences,"label-width":"100px",size:"small"}},[t("el-form-item",{attrs:{label:"默认模型"}},[t("el-select",{attrs:{placeholder:"选择默认模型"},model:{value:e.preferences.defaultModel,callback:function(t){e.$set(e.preferences,"defaultModel",t)},expression:"preferences.defaultModel"}},[t("el-option",{attrs:{label:"GPT-4o",value:"GPT-4o"}}),t("el-option",{attrs:{label:"deepseek-v3",value:"deepseek-v3"}}),t("el-option",{attrs:{label:"Qwen2.5-Max",value:"Qwen2.5-Max"}})],1)],1),t("el-form-item",{attrs:{label:"主题"}},[t("el-radio-group",{model:{value:e.preferences.theme,callback:function(t){e.$set(e.preferences,"theme",t)},expression:"preferences.theme"}},[t("el-radio-button",{attrs:{label:"light"}},[e._v("明亮模式")]),t("el-radio-button",{attrs:{label:"dark"}},[e._v("暗黑模式")]),t("el-radio-button",{attrs:{label:"auto"}},[e._v("跟随系统")])],1)],1),t("el-form-item",{attrs:{label:"语言"}},[t("el-radio-group",{model:{value:e.preferences.language,callback:function(t){e.$set(e.preferences,"language",t)},expression:"preferences.language"}},[t("el-radio-button",{attrs:{label:"zh-CN"}},[e._v("中文")]),t("el-radio-button",{attrs:{label:"en-US"}},[e._v("English")])],1)],1)],1)],1),t("el-tab-pane",{attrs:{label:"字体设置",name:"font"}},[t("el-form",{attrs:{model:e.preferences.font,"label-width":"100px",size:"small"}},[t("el-form-item",{attrs:{label:"字体样式"}},[t("el-select",{attrs:{placeholder:"选择字体"},model:{value:e.preferences.font.family,callback:function(t){e.$set(e.preferences.font,"family",t)},expression:"preferences.font.family"}},[t("el-option",{attrs:{label:"系统默认",value:""}}),t("el-option",{attrs:{label:"微软雅黑",value:"Microsoft YaHei"}}),t("el-option",{attrs:{label:"宋体",value:"SimSun"}}),t("el-option",{attrs:{label:"黑体",value:"SimHei"}}),t("el-option",{attrs:{label:"Arial",value:"Arial"}}),t("el-option",{attrs:{label:"Roboto",value:"Roboto"}})],1)],1),t("el-form-item",{attrs:{label:"字体大小"}},[t("el-slider",{attrs:{min:12,max:20,step:1,"show-stops":"","show-input":"","format-tooltip":e=>`${e}px`},model:{value:e.preferences.font.size,callback:function(t){e.$set(e.preferences.font,"size",t)},expression:"preferences.font.size"}})],1),t("el-form-item",{attrs:{label:"预览"}},[t("div",{staticClass:"font-preview",style:e.previewStyle},[e._v(" 这是字体预览文本。这是一段用于展示所选字体样式和大小效果的示例文本。 ")])])],1)],1),t("el-tab-pane",{attrs:{label:"常用语",name:"prompts"}},[t("div",{staticClass:"custom-prompts"},[t("div",{staticClass:"prompts-header"},[t("h3",[e._v("我的常用语")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addNewPrompt}},[e._v("添加")])],1),t("div",{staticClass:"prompt-list"},[0===e.preferences.customPrompts.length?t("el-empty",{attrs:{description:"暂无常用语"}}):e._e(),e._l(e.preferences.customPrompts,(function(s,a){return t("div",{key:a,staticClass:"prompt-item"},[t("div",{staticClass:"prompt-content"},[t("el-input",{attrs:{type:"textarea",rows:2,resize:"none",placeholder:"输入常用语内容"},model:{value:s.content,callback:function(t){e.$set(s,"content",t)},expression:"prompt.content"}})],1),t("div",{staticClass:"prompt-actions"},[t("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.deletePrompt(a)}}})],1)])}))],2)])])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.savePreferences}},[e._v("保存")])],1)],1)},M=[],S={name:"UserPreferences",props:{visible:{type:Boolean,default:!1}},data(){return{activeTab:"general",preferences:{defaultModel:"GPT-4o",theme:"light",language:"zh-CN",font:{family:"",size:14},customPrompts:[]}}},computed:{previewStyle(){return{fontFamily:this.preferences.font.family||"inherit",fontSize:`${this.preferences.font.size}px`}}},watch:{visible(e){e&&this.loadPreferences()}},methods:{loadPreferences(){const e=localStorage.getItem("userPreferences");if(e)try{const t=JSON.parse(e);this.preferences={...this.preferences,...t},this.applyFontSettings()}catch(t){console.error("Error loading preferences:",t)}},savePreferences(){localStorage.setItem("userPreferences",JSON.stringify(this.preferences)),this.applyFontSettings(),this.$emit("save",this.preferences),this.$emit("update:visible",!1),this.$message({message:"偏好设置已保存",type:"success",duration:2e3})},applyFontSettings(){const e=this.preferences.font.family||"inherit",t=this.preferences.font.size||14;document.documentElement.style.setProperty("--app-font-family",e),document.documentElement.style.setProperty("--app-font-size",`${t}px`);const s=document.getElementById("user-font-style")||document.createElement("style");s.id="user-font-style",s.textContent=`\n        .chat-messages .message-content,\n        .chat-messages .message-text,\n        .history-item .history-title,\n        .prompt-item,\n        .greeting-subtitle,\n        .chat-input .el-textarea__inner {\n          font-size: ${t}px !important;\n          font-family: ${e} !important;\n        }\n        \n        .message-header .model-name,\n        .message-header .response-time,\n        .message-header .send-time {\n          font-size: ${Math.max(t-2,10)}px !important;\n        }\n        \n        .greeting-title {\n          font-size: ${t+6}px !important;\n        }\n      `,document.getElementById("user-font-style")||document.head.appendChild(s)},cancel(){this.$emit("update:visible",!1)},handleClose(){this.$emit("update:visible",!1)},addNewPrompt(){this.preferences.customPrompts.push({content:"",createdAt:(new Date).toISOString()})},deletePrompt(e){this.preferences.customPrompts.splice(e,1)}},mounted(){this.loadPreferences()}},I=S,E=(0,u.A)(I,P,M,!1,null,"3847785a",null),T=E.exports,U=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"share-dialog",attrs:{title:"共享历史记录",visible:e.localVisible,width:"500px"},on:{"update:visible":function(t){e.localVisible=t}}},[t("div",{staticClass:"share-content"},[t("p",{staticClass:"share-text"},[e._v("共享链接: "+e._s(e.shareLink))]),t("el-button",{attrs:{type:"primary"},on:{click:e.copyLink}},[e._v("复制链接")])],1)])},L=[],D={name:"ShareDialog",props:{visible:{type:Boolean,default:!1},shareLink:{type:String,default:""}},data(){return{localVisible:this.visible}},watch:{visible(e){this.localVisible=e},localVisible(e){this.$emit("update:visible",e),e||this.$emit("close")}},methods:{copyLink(){const e=document.createElement("input");e.value=this.shareLink,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$message({message:"链接已复制到剪贴板",type:"success",duration:2e3})}}},z=D,q=(0,u.A)(z,U,L,!1,null,"fa099388",null),N=q.exports,F={name:"ChatView",components:{AppLayout:$,UserPreferences:T,ShareDialog:N,AccountModal:p},data(){return{userInput:"",currentChatIndex:0,sidebarActive:!0,preferencesVisible:!1,accountModalVisible:!1,inputExpanded:!1,shareDialogVisible:!1,shareLink:"",selectedStyle:"",currentModel:"GPT-4o",chatHistoryList:[{id:1,title:"关于健康饮食的讨论",messages:[{role:"user",content:"健康饮食的基本原则是什么？"},{role:"assistant",content:"健康饮食的基本原则包括：均衡营养、适量饮食、多样化食物选择、减少加工食品、控制糖和盐的摄入等。建议增加蔬果摄入，选择全谷物，摄入优质蛋白质，限制饱和脂肪。",model:"GPT-4o",time:"2024-06-01 10:15"}]},{id:2,title:"Python编程问题",messages:[{role:"user",content:"如何在Python中处理JSON数据？"},{role:"assistant",content:"在Python中处理JSON数据，可以使用内置的json模块。主要有四个函数：json.loads()将JSON字符串转为Python对象，json.dumps()将Python对象转为JSON字符串，json.load()从文件中读取JSON，json.dump()将Python对象写入JSON文件。",model:"GPT-4o",time:"2024-06-01 11:30"}]},{id:3,title:"生成一张猫咪图片",messages:[{role:"user",content:"帮我生成一张可爱的橙色猫咪图片，卡通风格"},{role:"assistant",content:"这是您要求的可爱橙色猫咪图片，采用了卡通风格：",imageUrl:"https://example.com/cat_image.jpg",model:"GPT-4o",time:"2024-06-02 14:25"}]},{id:4,title:"新对话",messages:[]}],styles:[{value:"写实风格",label:"写实风格"},{value:"卡通风格",label:"卡通风格"},{value:"水彩风格",label:"水彩风格"},{value:"油画风格",label:"油画风格"},{value:"赛博朋克",label:"赛博朋克"}]}},computed:{...(0,l.L8)(["availableModels","currentUser","isAdmin"]),userInitial(){return this.currentUser?this.currentUser.username.charAt(0).toUpperCase():"?"},currentChat(){return this.chatHistoryList[this.currentChatIndex]||{id:0,title:"新对话",messages:[]}},isMobile(){return window.innerWidth<=767},isImageModel(){return!1}},methods:{...(0,l.i0)(["logout","toggleAccountModal"]),async sendMessageToBackend(e){try{const t=await fetch(`http://localhost:8080/chat?prompt=${encodeURIComponent(e)}`,{method:"GET",headers:{Accept:"*/*"},mode:"cors",credentials:"omit"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.text();return s}catch(t){if(console.error("发送消息失败:",t),t.message.includes("CORS"))throw new Error("跨域请求被拒绝，请确保后端服务器允许跨域访问");throw new Error("与服务器通信失败，请检查网络连接或服务器状态")}},async sendMessage(){if(!this.userInput.trim())return;0===this.currentChat.messages.length&&(this.currentChat.title=this.userInput.substring(0,10)+(this.userInput.length>10?"...":"")),this.currentChat.messages.push({role:"user",content:this.userInput,time:(new Date).toLocaleString("zh-CN",{hour12:!1})});const e=this.userInput;this.userInput="";try{const t=await this.sendMessageToBackend(e),s=t.includes("<img");if(s){const e=t.match(/src='([^']*)'/)||t.match(/src="([^"]*)"/),s=e?e[1]:null;this.currentChat.messages.push({role:"assistant",content:"生成的图片：",imageUrl:s,model:this.currentModel,time:(new Date).toLocaleString("zh-CN",{hour12:!1})})}else this.currentChat.messages.push({role:"assistant",content:t,model:this.currentModel,time:(new Date).toLocaleString("zh-CN",{hour12:!1})});this.$nextTick((()=>{const e=this.$refs.chatHistory;e&&(e.scrollTop=e.scrollHeight)}))}catch(t){this.currentChat.messages.push({role:"assistant",content:`错误: ${t.message}`,model:this.currentModel,time:(new Date).toLocaleString("zh-CN",{hour12:!1})}),this.$message.error(t.message),console.error("发送消息失败:",t)}},selectPrompt(e){this.userInput=e},handleCommand(e){"profile"===e?this.accountModalVisible=!0:"logout"===e?(this.$store.dispatch("logout"),this.$router.push("/login")):"admin"===e?this.$router.push("/admin"):"preferences"===e&&(this.preferencesVisible=!0)},switchChat(e){this.currentChatIndex=e,this.$nextTick((()=>{const e=this.$refs.chatHistory;e&&this.currentChat.messages.length>0&&(e.scrollTop=e.scrollHeight)})),this.isMobile&&(this.sidebarActive=!1)},createNewChat(){this.chatHistoryList.unshift({id:Date.now(),title:"新对话",messages:[]}),this.currentChatIndex=0,this.isMobile&&(this.sidebarActive=!1)},handleChatAction(e,t){"rename"===e?this.$prompt("请输入新的对话名称","重命名",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.chatHistoryList[t].title}).then((({value:e})=>{e&&(this.chatHistoryList[t].title=e,this.$message({type:"success",message:"重命名成功"}))})).catch((()=>{})):"share"===e?this.exportChat(t):"delete"===e&&this.$confirm("确定删除该对话吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.chatHistoryList.splice(t,1),0===this.chatHistoryList.length&&this.chatHistoryList.push({id:Date.now(),title:"新对话",messages:[]}),t===this.currentChatIndex?this.currentChatIndex=0:t<this.currentChatIndex&&this.currentChatIndex--,this.$message({type:"success",message:"删除成功!"})})).catch((()=>{}))},toggleSidebar(){this.sidebarActive=!this.sidebarActive},toggleInputExpanded(){this.inputExpanded=!this.inputExpanded},exportChat(e){const t=this.chatHistoryList[e],s=JSON.stringify(t,null,2),a=new Blob([s],{type:"application/json"}),r=URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=`${t.title}.json`,i.click(),URL.revokeObjectURL(r)},shareHistory(){0!==this.currentChat.messages.length?(this.shareLink=`https://chat.example.com/share/${this.currentChat.id}`,this.shareDialogVisible=!0):this.$message.warning("当前对话为空，无法共享")},savePreferences(e){console.log("保存偏好设置:",e),this.$message.success("偏好设置已保存")},likeMessage(e){e.liked=!e.liked,e.imageUrl&&e.liked?(this.saveImageToAdmin(e),this.$message.success("已点赞并保存到图片记录")):e.liked?this.$message.success("已点赞"):this.$message.info("已取消点赞")},saveImageToAdmin(e){console.log("保存图片到管理员面板",e.imageUrl)},downloadImage(e){if(e.imageUrl){const t=document.createElement("a");t.href=e.imageUrl,t.download=`image_${Date.now()}.jpg`,t.click()}},deleteMessage(e){this.$confirm("确定删除此消息吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.currentChat.messages.splice(e,1),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{}))},regenerateMessage(e){e>0&&"assistant"===this.currentChat.messages[e].role&&(this.currentChat.messages.splice(e,1),setTimeout((()=>{const t=this.currentChat.messages[e-1];this.currentChat.messages.splice(e,0,{role:"assistant",content:`这是重新生成的对"${t.content}"的回复。`,model:this.currentModel,time:(new Date).toLocaleString("zh-CN",{hour12:!1})})}),500))},uploadFile(){this.$message.info("文件上传功能尚未实现")},uploadImage(){this.$message.info("图片上传功能尚未实现")},startVoiceInput(){this.$message.info("语音输入功能尚未实现")},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.chatHistory;e&&(e.scrollTop=e.scrollHeight)}))},handleImageError(e){console.error("图片加载失败:",e),e.target.style.display="none",this.$message.error("图片加载失败")},changeModel(e){this.currentModel=e,this.$message.success(`已切换至 ${e} 模型`)},copyMessage(e){navigator.clipboard.writeText(e.content).then((()=>{this.$message.success("内容已复制到剪贴板")})).catch((e=>{this.$message.error("复制失败: "+e)}))}},mounted(){window.addEventListener("resize",(()=>{this.isMobile&&this.sidebarActive&&(this.sidebarActive=!1)}))}},V=F,O=(0,u.A)(V,y,C,!1,null,"001c9255",null),R=O.exports,j=function(){var e=this,t=e._self._c;return t("div",{staticClass:"model-access"},[e._m(0),t("div",{staticClass:"model-list"},e._l(e.models,(function(e){return t("ModelCard",{key:e.id,attrs:{title:e.title,status:e.status,description:e.desc}})})),1),t("el-button",{staticClass:"upgrade-btn",attrs:{type:"primary"}},[e._v(" Gemini Advanced 升级 ")])],1)},B=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h2",[e._v("模型接入")]),t("p",{staticClass:"subtitle"},[e._v("选择适合您需求的模型版本")])])}],H=function(){var e=this,t=e._self._c;return t("div",{staticClass:"model-card",class:{"is-experimental":"experimental"===e.status}},[t("div",{staticClass:"card-header"},[t("h3",[e._v(e._s(e.title))]),t("el-tag",{attrs:{type:"stable"===e.status?"success":"warning",size:"small"}},[e._v(" "+e._s("stable"===e.status?"稳定版":"实验版")+" ")])],1),t("p",{staticClass:"description"},[e._v(e._s(e.description))])])},G=[],Q={name:"AppModelCard",props:{title:{type:String,required:!0},status:{type:String,default:"stable",validator:e=>["stable","experimental"].includes(e)},description:{type:String,required:!0}}},J=Q,K=(0,u.A)(J,H,G,!1,null,"45fdf908",null),W=K.exports,Y={name:"ModelAccessView",components:{ModelCard:W},data(){return{models:[{id:1,title:"2.0 Flash",status:"stable",desc:"获得日常帮助"},{id:2,title:"2.5 Pro (experimental)",status:"experimental",desc:"处理复杂任务效果最好"}]}}},X=Y,Z=(0,u.A)(X,j,B,!1,null,"0c95596c",null),ee=Z.exports,te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-panel"},[t("div",{staticClass:"admin-header"},[t("h1",{staticClass:"admin-title"},[e._v("管理员权限面板")]),t("el-button",{staticClass:"back-btn",attrs:{type:"primary",size:"small",icon:"el-icon-back"},on:{click:e.backToHome}},[e._v("返回主页")])],1),t("el-card",{staticClass:"admin-description"},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("管理员权限范围")])]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.adminRights,size:"small"}},[t("el-table-column",{attrs:{prop:"role",label:"角色",width:"120"}}),t("el-table-column",{attrs:{prop:"permissions",label:"权限范围"}})],1)],1),t("div",{staticClass:"admin-functions"},[t("h2",[e._v("系统管理功能")]),t("div",{staticClass:"feature-grid"},e._l(e.adminFeatures,(function(s,a){return t("el-card",{key:a,staticClass:"feature-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-content"},[t("div",{staticClass:"feature-icon"},[t("i",{class:s.icon})]),t("div",{staticClass:"feature-info"},[t("h3",[e._v(e._s(s.title))]),t("p",[e._v(e._s(s.description))]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.navigateToFeature(s.route)}}},[e._v("进入管理")])],1)])])})),1)])],1)},se=[],ae={name:"AdminPanel",data(){return{adminRights:[{role:"管理员",permissions:"模型配置，用户管理，日志查看，提示词配置，内容记录查询，图片记录查询"}],adminFeatures:[{title:"模型配置",icon:"el-icon-cpu",description:"管理系统可用的AI模型、接口配置和调用参数",route:"/admin/model-config"},{title:"用户管理",icon:"el-icon-user",description:"管理系统用户账号、权限和角色分配",route:"/admin/user-management"},{title:"日志查看",icon:"el-icon-document",description:"查看系统操作日志和用户使用记录",route:"/admin/logs"},{title:"提示词配置",icon:"el-icon-chat-line-square",description:"管理系统预设提示词和对话模板",route:"/admin/prompt-config"},{title:"内容记录查询",icon:"el-icon-search",description:"查询和审核系统内的对话内容",route:"/admin/content-records"},{title:"图片记录查询",icon:"el-icon-picture-outline",description:"查询和管理用户生成的图片内容",route:"/admin/image-records"}]}},methods:{navigateToFeature(e){this.$route.path!==e&&this.$router.push(e)},backToHome(){this.$router.push("/")}}},re=ae,ie=(0,u.A)(re,te,se,!1,null,"17b006ec",null),ne=ie.exports,oe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-card"},[t("div",{staticClass:"login-title"},[e._v("茵小浪登录")]),t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.rules}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名","prefix-icon":"el-icon-user"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{placeholder:"密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",[t("el-button",{staticClass:"login-button",attrs:{type:"primary",loading:e.loading},on:{click:e.handleLogin}},[e._v(" 登录 ")])],1)],1)],1)])},le=[],ce={name:"Login",data(){return{loginForm:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loading:!1}},methods:{...(0,l.i0)(["login"]),handleLogin(){this.$refs.loginForm.validate((e=>{e&&(this.loading=!0,setTimeout((()=>{const e={username:this.loginForm.username,email:this.loginForm.username+"@example.com",role:"admin"===this.loginForm.username?"admin":"user"};this.login(e),this.loading=!1;const t=this.$route.query.redirect||"/";this.$router.push(t)}),1e3))}))}}},de=ce,ue=(0,u.A)(de,oe,le,!1,null,"19c78dd8",null),me=ue.exports,pe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-profile"},[t("div",{staticClass:"header"},[t("h1",[e._v("用户管理")]),t("div",{staticClass:"header-buttons"},[t("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-back"},on:{click:e.goBack}},[e._v("返回管理面板")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home"},on:{click:e.goHome}},[e._v("返回主页")])],1)]),t("div",{staticClass:"search-area"},[t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.queryParams.username,callback:function(t){e.$set(e.queryParams,"username",t)},expression:"queryParams.username"}})],1),t("el-form-item",{attrs:{label:"部门"}},[t("el-select",{attrs:{placeholder:"请选择部门",clearable:""},model:{value:e.queryParams.departmentId,callback:function(t){e.$set(e.queryParams,"departmentId",t)},expression:"queryParams.departmentId"}},e._l(e.departments,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"权限"}},[t("el-select",{attrs:{placeholder:"请选择权限",clearable:""},model:{value:e.queryParams.role,callback:function(t){e.$set(e.queryParams,"role",t)},expression:"queryParams.role"}},[t("el-option",{attrs:{label:"超级管理员",value:"SUPER_ADMIN"}}),t("el-option",{attrs:{label:"普通用户",value:"NORMAL_USER"}})],1)],1),t("el-form-item",{attrs:{label:"创建时间"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.queryParams.dateRange,callback:function(t){e.$set(e.queryParams,"dateRange",t)},expression:"queryParams.dateRange"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleQuery}},[e._v("查询")]),t("el-button",{on:{click:e.resetQuery}},[e._v("重置")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("创建新用户")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"departmentName",label:"所属部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDepartmentName(t.row.departmentId))+" ")]}}])}),t("el-table-column",{attrs:{prop:"role",label:"权限"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:"SUPER_ADMIN"===s.row.role?"danger":""}},[e._v(" "+e._s("SUPER_ADMIN"===s.row.role?"超级管理员":"普通用户")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"createdTime",label:"创建时间"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(s.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(s.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("span",{staticClass:"total-count"},[e._v("共 "+e._s(e.total)+" 条")]),t("el-pagination",{attrs:{"current-page":e.queryParams.pageNum,"page-sizes":[10,20,50,100],"page-size":e.queryParams.pageSize,layout:"prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("span",{staticClass:"page-info"},[e._v("前往 "+e._s(e.queryParams.pageNum)+" 页")])],1),t("el-dialog",{attrs:{title:"add"===e.dialogType?"创建新用户":"编辑用户",visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.resetForm}},[t("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),"add"===e.dialogType?t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码","show-password":""},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1):e._e(),t("el-form-item",{attrs:{label:"所属部门",prop:"departmentId"}},[t("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.formData.departmentId,callback:function(t){e.$set(e.formData,"departmentId",t)},expression:"formData.departmentId"}},e._l(e.departments,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"权限",prop:"role"}},[t("el-select",{attrs:{placeholder:"请选择权限"},model:{value:e.formData.role,callback:function(t){e.$set(e.formData,"role",t)},expression:"formData.role"}},[t("el-option",{attrs:{label:"普通用户",value:"NORMAL_USER"}}),t("el-option",{attrs:{label:"超级管理员",value:"SUPER_ADMIN"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"提示",visible:e.deleteDialogVisible,width:"300px"},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[t("div",{staticClass:"delete-confirm"},[t("i",{staticClass:"el-icon-warning"}),t("span",[e._v("确认删除该用户吗？")])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deleteDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmDelete}},[e._v("确定")])],1)])],1)},he=[],fe=(s(116),s(2549)),ge=s(364),ve={name:"UserProfile",data(){return{queryParams:{pageNum:1,pageSize:10,username:"",departmentId:void 0,role:"",dateRange:[]},tableData:[],loading:!1,total:0,departments:[],dialogVisible:!1,dialogType:"add",deleteDialogVisible:!1,deleteUserId:null,formData:{username:"",password:"",departmentId:void 0,role:"NORMAL_USER"},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"change"}],role:[{required:!0,message:"请选择权限",trigger:"change"}]}}},methods:{goBack(){"/admin"!==this.$route.path&&this.$router.push("/admin")},goHome(){"/"!==this.$route.path&&this.$router.push("/")},async fetchDepartments(){try{const e=await(0,ge.zz)();this.departments=Array.isArray(e.data)?e.data:[]}catch(e){console.error("获取部门列表失败:",e),this.$message.error("获取部门列表失败")}},async fetchUserList(){this.loading=!0;try{const e=await(0,fe.aU)(this.queryParams);this.tableData=e.list||[],this.total=e.total||0}catch(e){console.error("获取用户列表失败:",e),this.$message.error("获取用户列表失败")}finally{this.loading=!1}},handleQuery(){this.queryParams.pageNum=1,this.fetchUserList()},resetQuery(){this.queryParams={pageNum:1,pageSize:10,username:"",departmentId:void 0,role:"",dateRange:[]},this.fetchUserList()},handleSizeChange(e){this.queryParams.pageSize=e,this.fetchUserList()},handleCurrentChange(e){this.queryParams.pageNum=e,this.fetchUserList()},handleAdd(){this.dialogType="add",this.formData={username:"",password:"",departmentId:void 0,role:"NORMAL_USER"},this.dialogVisible=!0},handleEdit(e){this.dialogType="edit",this.formData={id:e.id,username:e.username,departmentId:e.departmentId,role:e.role},this.dialogVisible=!0},handleDelete(e){this.deleteUserId=e.id,this.deleteDialogVisible=!0},async confirmDelete(){try{await(0,fe.hG)(this.deleteUserId),this.$message.success("删除成功"),this.deleteDialogVisible=!1,this.fetchUserList()}catch(e){console.error("删除失败:",e),this.$message.error("删除失败")}},async submitForm(){try{if(await this.$refs.form.validate(),"add"===this.dialogType)await(0,fe.kg)(this.formData),this.$message.success("创建成功");else{const{id:e,...t}=this.formData;await(0,fe.TK)(e,t),this.$message.success("更新成功")}this.dialogVisible=!1,this.fetchUserList()}catch(e){console.error("操作失败:",e),this.$message.error("操作失败")}},resetForm(){this.$refs.form&&this.$refs.form.resetFields(),this.formData={username:"",password:"",departmentId:void 0,role:"NORMAL_USER"}},getDepartmentName(e){if(!e)return"未分配";const t=this.departments.find((t=>t.id===e));return t?t.name:"未知部门"}},created(){this.fetchDepartments(),this.fetchUserList()}},be=ve,ye=(0,u.A)(be,pe,he,!1,null,"76da4248",null),Ce=ye.exports;a["default"].use(l.Ay);var _e=new l.Ay.Store({state:{isAccountModalVisible:!1,currentModel:"deepseek-v3",user:null,isAuthenticated:!1,availableModels:[{id:1,name:"Kimi",description:"获得日常帮助",tag:"新"},{id:2,name:"DeepSeek",description:"具备高级推理能力",tag:"新"},{id:3,name:"GPT-4o",description:"处理复杂任务效果最好",tag:"新"}]},mutations:{TOGGLE_ACCOUNT_MODAL(e){e.isAccountModalVisible=!e.isAccountModalVisible},SET_CURRENT_MODEL(e,t){e.currentModel=t},SET_USER(e,t){e.user=t,e.isAuthenticated=!0},CLEAR_USER(e){e.user=null,e.isAuthenticated=!1}},actions:{toggleAccountModal({commit:e}){e("TOGGLE_ACCOUNT_MODAL")},setCurrentModel({commit:e},t){e("SET_CURRENT_MODEL",t)},login({commit:e},t){e("SET_USER",t)},logout({commit:e}){e("CLEAR_USER")}},getters:{isAccountModalVisible:e=>e.isAccountModalVisible,currentModel:e=>e.currentModel,userEmail:e=>e.user?e.user.email:"",availableModels:e=>e.availableModels,isAdmin:e=>e.user&&"admin"===e.user.role,currentUser:e=>e.user,isLoggedIn:e=>e.isAuthenticated}});a["default"].use(b.Ay);const we=[{path:"/login",name:"Login",component:me,meta:{isPublic:!0}},{path:"/",name:"Chat",component:R,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:Ce,meta:{requiresAuth:!0}},{path:"/model-access",name:"ModelAccess",component:ee,meta:{requiresAuth:!0}},{path:"/admin",name:"AdminPanel",component:ne,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/user-management",name:"UserManagement",component:()=>s.e(979).then(s.bind(s,9979)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/logs",name:"LogViewer",component:()=>s.e(406).then(s.bind(s,4406)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/prompt-config",name:"PromptConfig",component:()=>s.e(101).then(s.bind(s,7101)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/content-records",name:"ContentRecords",component:()=>s.e(840).then(s.bind(s,3840)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/image-records",name:"ImageRecords",component:()=>s.e(671).then(s.bind(s,1671)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/model-config",name:"ModelConfig",component:()=>s.e(196).then(s.bind(s,4196)),meta:{requiresAuth:!0,requiresAdmin:!0}}],ke=new b.Ay({mode:"hash",base:"/",routes:we});ke.beforeEach(((e,t,s)=>{const a=_e.getters.currentUser,r=_e.getters.isAdmin;e.matched.some((e=>e.meta.isPublic))?s():e.matched.some((e=>e.meta.requiresAuth))?a?e.matched.some((e=>e.meta.requiresAdmin))&&!r?s({path:"/"}):s():s({path:"/login",query:{redirect:e.fullPath}}):s()}));var Ae=ke,xe=s(9143),$e=s.n(xe),Pe=s(4373);Pe.A.defaults.baseURL={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_BASE_API||"http://localhost:8080/api",Pe.A.defaults.timeout=15e3,Pe.A.defaults.headers.post["Content-Type"]="application/json",Pe.A.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e))),a["default"].use($e()),a["default"].prototype.$axios=Pe.A,a["default"].config.productionTip=!1,new a["default"]({router:Ae,store:_e,render:e=>e(v)}).$mount("#app")},5720:function(e,t,s){s(8111),s(7588);var a=s(4373),r=s(9143);const i=a.A.create({baseURL:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_BASE_API||"",timeout:15e3,headers:{"Content-Type":"application/json"}});i.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),"get"===e.method&&e.params&&Object.keys(e.params).forEach((t=>{void 0!==e.params[t]&&null!==e.params[t]||delete e.params[t]})),e}),(e=>(console.error("请求错误:",e),Promise.reject(e)))),i.interceptors.response.use((e=>{if("blob"===e.config.responseType)return e;const t=e.data;return Array.isArray(t)||"object"===typeof t&&null!==t&&!t.code?{code:200,data:t,message:"success"}:t.code&&200!==t.code?((0,r.Message)({message:t.message||"请求失败",type:"error",duration:5e3}),Promise.reject(new Error(t.message||"请求失败"))):t}),(e=>{console.error("响应错误:",e);const{response:t}=e;let s="服务器错误";if(t)switch(t.status){case 400:s=t.data?.message||"请求参数错误";break;case 401:s="未授权，请重新登录",localStorage.removeItem("token"),setTimeout((()=>{window.location.href="/login"}),1500);break;case 403:s="拒绝访问";break;case 404:s="请求的资源不存在";break;case 500:s="服务器错误";break;default:s=t.data?.message||`请求失败(${t.status})`}else s=e.request?"网络错误，请检查您的网络连接":e.message;return(0,r.Message)({message:s,type:"error",duration:5e3}),Promise.reject(e)})),t.A=i},8178:function(e,t,s){e.exports=s.p+"img/ai.6d708718.png"}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=e,function(){s.amdO={}}(),function(){var e=[];s.O=function(t,a,r,i){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],r=e[d][1],i=e[d][2];for(var o=!0,l=0;l<a.length;l++)(!1&i||n>=i)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(o=!1,i<n&&(n=i));if(o){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,r,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,a){return s.f[a](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/"+e+"."+{101:"f4f88c08",196:"af19ba29",406:"6454cd55",671:"5f0dfe62",840:"125e67e0",979:"f76fb3ff"}[e]+".js"}}(),function(){s.miniCssF=function(e){return"css/"+e+"."+{101:"e58373f3",196:"9dabdbfe",406:"a30fde3c",671:"8e4e2e68",840:"61612e4a",979:"d3b09cfe"}[e]+".css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="agentui:";s.l=function(a,r,i,n){if(e[a])e[a].push(r);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+i){o=u;break}}o||(l=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+i),o.src=a),e[a]=[r];var m=function(t,s){o.onerror=o.onload=null,clearTimeout(p);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(e){return e(s)})),t)return t(s)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){s.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,r,i){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",s.nc&&(n.nonce=s.nc);var o=function(s){if(n.onerror=n.onload=null,"load"===s.type)r();else{var a=s&&s.type,o=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+o+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=o,n.parentNode&&n.parentNode.removeChild(n),i(l)}};return n.onerror=n.onload=o,n.href=t,a?a.parentNode.insertBefore(n,a.nextSibling):document.head.appendChild(n),n},t=function(e,t){for(var s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var r=s[a],i=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===e||i===t))return r}var n=document.getElementsByTagName("style");for(a=0;a<n.length;a++){r=n[a],i=r.getAttribute("data-href");if(i===e||i===t)return r}},a=function(a){return new Promise((function(r,i){var n=s.miniCssF(a),o=s.p+n;if(t(n,o))return r();e(a,o,null,r,i)}))},r={524:0};s.f.miniCss=function(e,t){var s={101:1,196:1,406:1,671:1,840:1,979:1};r[e]?t.push(r[e]):0!==r[e]&&s[e]&&t.push(r[e]=a(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}}(),function(){var e={524:0};s.f.j=function(t,a){var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var i=new Promise((function(s,a){r=e[t]=[s,a]}));a.push(r[2]=i);var n=s.p+s.u(t),o=new Error,l=function(a){if(s.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var i=a&&("load"===a.type?"missing":a.type),n=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",o.name="ChunkLoadError",o.type=i,o.request=n,r[1](o)}};s.l(n,l,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,i,n=a[0],o=a[1],l=a[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);if(l)var d=l(s)}for(t&&t(a);c<n.length;c++)i=n[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},a=self["webpackChunkagentui"]=self["webpackChunkagentui"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(5414)}));a=s.O(a)})();
//# sourceMappingURL=app.7f00a690.js.map